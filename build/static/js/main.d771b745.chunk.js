(this["webpackJsonpadmin-please"]=this["webpackJsonpadmin-please"]||[]).push([[0],{164:function(e,t,n){e.exports={formLoadingWrappper:"formLoadingWrappper___3usrP",buttonArea:"buttonArea___RLdpg"}},165:function(e,t,n){e.exports={header:"header___3lOkm",requiredStar:"requiredStar___cER25"}},194:function(e,t,n){e.exports={actionHeader:"actionHeader___1Qm6Y"}},213:function(e,t,n){e.exports={pageWrapper:"pageWrapper___392-U"}},221:function(e,t,n){e.exports={logout:"logout___3Us4T"}},222:function(e,t,n){e.exports={loginForm:"loginForm___2AqeY"}},223:function(e,t,n){e.exports={pageLoader:"pageLoader___2KOqt"}},230:function(e,t,n){e.exports=n(416)},415:function(e,t,n){},416:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(21),c=n.n(i),o=n(28),s=n(45),u=n(26),l=n(32),d=n.n(l),m=n(52),p=n(161),f="https://api.preze.live/graphql",g=function(){var e=Object(m.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return a=e.sent,e.abrupt("return",a[n]);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),b={request:function(){}},h="",E=function(e){h="Bearer ".concat(e),b=new p.GraphQLClient(f,{headers:{authorization:h}})},v={users:{list:function(){return console.log({TOKEN:h}),g(b.request("\n\tquery adminListAllUsers {\n\t\tadminListAllUsers {\n\t\t\tid\n\t\t\tfirstName\n\t\t\tlastName\n\t\t\temail\n\t\t\tcreatedAt\n\t\t\tpassword\n\t\t\tisAdmin\n\t\t\tsessionsCount\n\t\t}\n\t}\n"),"adminListAllUsers")},detail:function(e){return g(b.request("\n\tquery adminListUser ($userId: ID!) {\n\t\tadminListUser (userId: $userId) {\n\t\t\tid\n\t\t\tfirstName\n\t\t\tlastName\n\t\t\temail\n\t\t\tcreatedAt\n\t\t\tpassword\n\t\t\tisAdmin\n\t\t\tsessionsCount\n\t\t}\n\t}\n",{userId:e}),"adminListUser")},edit:function(e,t){return g(b.request("\n\tmutation adminUpdateUser ($userId: ID!, $updateUserInput: UpdateUserInput!) {\n\t\tadminUpdateUser (userId: $userId, updateUserInput: $updateUserInput)\n\t}\n",{userId:e,updateUserInput:t}),"adminUpdateUser")},create:function(e){return g(b.request("\n\tmutation adminCreateUser ($adminCreateUserInput: AdminCreateUserInput!) {\n\t\tadminCreateUser (adminCreateUserInput: $adminCreateUserInput)\n\t}\n",{adminCreateUserInput:e}),"adminUpdateUser")}},logs:{list:function(){return g(b.request("\n\tquery adminListAllLogs {\n\t\tadminListAllLogs {\n\t\t\tid\n\t\t\tuser\n\t\t\taction\n\t\t\tcreatedAt\n\t\t}\n\t}\n"),"adminListAllLogs")},detail:function(e){return g(b.request("\n\tquery adminListLog ($id: ID!) {\n\t\tadminListLog (id: $id) {\n\t\t\tid\n\t\t\tuser\n\t\t\taction\n\t\t\tcreatedAt\n\t\t}\n\t}\n",{id:e}),"adminListLog")}},adminPleaseSystemAuth:{login:function(e,t){return g(Object(p.request)(f,"\n\tmutation adminLoginUser ($email: String!, $password: String!) {\n\t\tadminLoginUser (email: $email, password: $password) {\n\t\t\ttoken\n\t\t}\n\t}\n",{email:e,password:t}),"adminLoginUser")}}},y=n(37),O=n(418),j=n(425),k=n(426),w=n(194),C=n.n(w),U=function(e){var t=e.dataDefinition,n=e.dataProviderKey,i=e.actions,c=Object(u.f)(),l=Object(a.useState)(!0),p=Object(o.a)(l,2),f=p[0],g=p[1],b=Object(a.useState)([]),h=Object(o.a)(b,2),E=h[0],w=h[1],U=i.includes("create"),L=function(){var e=Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.next=3,v[n].list();case 3:t=e.sent,w(t),g(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){L()}),[]);var I=Object(a.useCallback)((function(){return Object.keys(t).filter((function(e){return t[e].list})).map((function(e,n){return{title:e,dataIndex:e,key:"".concat(e,"-").concat(n),render:t[e].render}}))}),[t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:C.a.actionHeader},r.a.createElement("div",null,r.a.createElement(y.a,{loading:f,icon:r.a.createElement(j.a,null),onClick:L})),U&&r.a.createElement(s.b,{to:"/".concat(n,"/detail/")},r.a.createElement(y.a,{icon:r.a.createElement(k.a,null)},"Create"))),r.a.createElement(O.a,{loading:f,dataSource:E,columns:I(),onRow:function(e){return{onClick:function(){return t=e.id,c.push("/".concat(n,"/detail/").concat(t));var t}}}}))},L=n(38),I=n.n(L),x={menu:[{title:"Dashboard",pathname:"/"},{title:"Users",pathname:"/users"},{title:"Logs",pathname:"/logs"}],pages:{users:{dataProviderKey:"users",actions:["create"],dataDefinition:{sessionsCount:{type:"number",component:"input",editable:!1,list:!0},id:{type:"string",component:"input",editable:!1,list:!0},password:{type:"string",component:"input",editable:!0,required:!0},email:{type:"string",component:"input",editable:!0,required:!0,list:!0},firstName:{type:"string",component:"input",editable:!0,list:!0},createdAt:{type:"string",component:"datepicker",editable:!0,render:function(e){return e?I()(e).format("HH:MM DD/MM/YYYY"):e},list:!0},isAdmin:{type:"boolean",component:"switch",editable:!0}}},logs:{dataProviderKey:"logs",dataDefinition:{id:{type:"string",component:"input",editable:!1,list:!0},user:{type:"string",component:"input",required:!0,editable:!0,list:!0},action:{type:"string",component:"input",editable:!0,list:!0},createdAt:{type:"string",component:"datepicker",editable:!0,render:function(e){return e?I()(e).format("HH:MM DD/MM/YYYY"):e},list:!0}}}}},_=n(420),S=n(213),q=n.n(S),A=function(e){var t=e.title,n=e.children;return r.a.createElement(_.a,{title:t,className:q.a.pageWrapper},n)},D=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},N=n(423),$=n(125),P=n(101),K=n(422),Y=n(211),M=n(417),T=n(88),W=n(43),F=n(427),H=n(164),B=n.n(H),z=n(165),R=n.n(z),J=function(e){var t=e.required,n=e.name,a=e.children;return r.a.createElement("div",null,r.a.createElement("header",{className:R.a.header},r.a.createElement("h3",null,n),t&&r.a.createElement("span",{className:R.a.requiredStar},"*")),a)},Q=n(421),G=function(e){var t=e.placeholder,n=e.value,a=e.disabled,i=e.onChange;return r.a.createElement(Q.a,{placeholder:t,value:n,disabled:a,onChange:function(e){return i(e.target.value)}})},V=n(419),X=function(e){var t=e.value,n=e.disabled,a=e.onChange;return r.a.createElement(V.a,{showTime:!0,value:t?I()(t):void 0,disabled:n,onChange:function(e,t){return a(t)}})},Z=n(424),ee={input:G,datepicker:X,switch:function(e){var t=e.disabled,n=e.value,a=e.onChange;return r.a.createElement(Z.a,{disabled:t,checked:n,onChange:a})}},te=function(e){var t=e.id,n=e.dataProviderKey,i=e.dataDefinition,c=Object(u.f)(),l=Object(a.useState)(!1),p=Object(o.a)(l,2),f=p[0],g=p[1],b=Object(a.useState)(!0),h=Object(o.a)(b,2),E=h[0],O=h[1],j=Object(a.useState)({}),k=Object(o.a)(j,2),w=k[0],C=k[1],U=Object(a.useState)({}),L=Object(o.a)(U,2),I=L[0],x=L[1],_=!t;Object(a.useEffect)((function(){var e=function(){var e=Object(m.a)(d.a.mark((function e(){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v[n].detail(t);case 2:a=e.sent,C(a),O(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();_?O(!1):e()}),[]);var S=function(){var e=Object(m.a)(d.a.mark((function e(a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g(!0),!_){e.next=4;break}return e.next=4,v[n].create(I);case 4:return e.next=6,v[n].edit(t,I);case 6:C(Object(P.a)(Object(P.a)({},w),I)),x({}),g(!1),K.a.success({message:"".concat(n," has been ").concat(_?"created":"saved"," successfully")}),a&&c.push("/".concat(n));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(E)return r.a.createElement("section",{className:B.a.formLoadingWrappper},r.a.createElement(Y.a,null));var q=0===Object.keys(I).length;return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,null,r.a.createElement(s.b,{to:"/".concat(n)},"Back")),r.a.createElement(M.a,null),r.a.createElement(T.a,{gutter:16},Object.keys(i).map((function(e){var t=ee[i[e].component];return t?r.a.createElement(W.a,{span:6,key:e},r.a.createElement(J,{name:e,required:i[e].required},r.a.createElement(t,{placeholder:e,value:"boolean"!==i[e].type?I[e]||w[e]||"":"boolean"===typeof I[e]?I[e]:w[e],disabled:!i[e].editable,onChange:function(t){return function(e,t){var n=Object(P.a)(Object(P.a)({},I),{},Object($.a)({},e,t));console.log({next:n[e],data:w[e],cond:n[e]===w[e]}),n[e]===w[e]&&delete n[e],x(n)}(e,t)}}))):(console.error("Missing component ".concat(i[e].component)),r.a.createElement(N.a,{message:"Error",description:"This component doesn't exist",type:"error",showIcon:!0}))}))),r.a.createElement(M.a,null),r.a.createElement("div",{className:B.a.buttonArea},f?r.a.createElement(F.a,{spin:!0}):r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,null,r.a.createElement(s.b,{to:"/".concat(n)},"Cancel")),r.a.createElement(y.a,{type:"primary",disabled:q,onClick:function(){return S(!0)}},_?"Create":"Save"," and close"),r.a.createElement(y.a,{type:"primary",disabled:q,onClick:function(){return S()}},_?"Create":"Save"))))},ne=n(72),ae=n(221),re=n.n(ae),ie=r.a.createContext({token:null}),ce=function(){var e=Object(u.f)(),t=Object(a.useContext)(ie).setToken,n=Object(a.useState)(e.location.pathname),i=Object(o.a)(n,2),c=i[0],l=i[1];e.listen((function(e){l(e.pathname)}));return r.a.createElement(ne.a,{mode:"horizontal",theme:"dark",selectedKeys:[c]},x.menu.map((function(e){return r.a.createElement(ne.a.Item,{key:e.pathname},r.a.createElement(s.b,{to:e.pathname},e.title))})),r.a.createElement(ne.a.Item,{className:re.a.logout,onClick:function(){t(null),window.localStorage.removeItem("admin.please.token")}},"Logout"))},oe=function(){var e=Object.keys(x.pages);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ce,null),r.a.createElement(u.c,null,e.map((function(e){return r.a.createElement(u.a,{key:e,path:"/".concat(e,"/detail/:id?"),component:function(t){var n=t.match.params.id;return r.a.createElement(A,{title:D(e)},r.a.createElement(te,{dataProviderKey:x.pages[e].dataProviderKey,dataDefinition:x.pages[e].dataDefinition,id:n}))}})})),e.map((function(e){return r.a.createElement(u.a,{key:e,path:"/".concat(e),component:function(){return r.a.createElement(A,{title:D(e)},r.a.createElement(U,{dataProviderKey:x.pages[e].dataProviderKey,dataDefinition:x.pages[e].dataDefinition,actions:x.pages[e].actions||[]}))}})})),r.a.createElement(u.a,{render:function(){return r.a.createElement(A,null,r.a.createElement(N.a,{message:"Error",description:"This component doesn't exist",type:"error",showIcon:!0}))}})))},se=n(222),ue=n.n(se),le=function(){var e=Object(a.useContext)(ie).setToken,t=Object(a.useState)(!1),n=Object(o.a)(t,2),i=n[0],c=n[1],s=Object(a.useState)(""),u=Object(o.a)(s,2),l=u[0],p=u[1],f=Object(a.useState)(""),g=Object(o.a)(f,2),b=g[0],h=g[1],E=function(){var t=Object(m.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c(!0),t.prev=1,t.next=4,v.adminPleaseSystemAuth.login(l,b);case 4:n=t.sent,e(n.token),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0),K.a.error({message:"Login failed"});case 12:c(!1);case 13:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}(),O=0===l.length||0===b.length;return r.a.createElement(_.a,{className:ue.a.loginForm},r.a.createElement("h3",null,"Name"),r.a.createElement(Q.a,{value:l,onChange:function(e){return p(e.target.value)}}),r.a.createElement("h3",null,"Password"),r.a.createElement(Q.a,{type:"password",value:b,onChange:function(e){return h(e.target.value)}}),r.a.createElement(y.a,{loading:i,type:"primary",onClick:E,disabled:O},"Login"))},de=n(223),me=n.n(de),pe=function(){return r.a.createElement("section",{className:me.a.pageLoader},r.a.createElement(Y.a,null))},fe=function(e){return e.token?r.a.createElement(s.a,null,r.a.createElement(oe,null)):r.a.createElement(le,null)},ge=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)(),s=Object(o.a)(c,2),u=s[0],l=s[1];Object(a.useEffect)((function(){var e=window.localStorage.getItem("admin.please.token");e&&(E(e),l(e)),i(!0)}),[]);return n?r.a.createElement(ie.Provider,{value:{token:u,setToken:function(e){E(e),l(e),window.localStorage.setItem("admin.please.token",e)}}},r.a.createElement(fe,{token:u})):r.a.createElement(pe,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(415);c.a.render(r.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[230,1,2]]]);
//# sourceMappingURL=main.d771b745.chunk.js.map